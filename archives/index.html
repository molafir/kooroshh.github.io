
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Tech With K">
    <title>Archives - Tech With K</title>
    <meta name="author" content="Koorosh">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Tech With K">
<meta property="og:url" content="https://blog.koorosh.dev/archives/index.html">
<meta property="og:site_name" content="Tech With K">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Koorosh">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@kooroshh">
    
    
        
    
    
        <meta property="og:image" content="https://www.gravatar.com/avatar/0f50eb4dae65a5398f5884cbbc063ace?s=640"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="../assets/css/style-z2okfa75rcu6q4cwqnoylclanmmvpaem0pebnxezbgqzaqfa3yvzryednl7s.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="../index.html"
            aria-label=""
        >
            Tech With K
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="../#about"
                aria-label="Open the link: ../#about"
            >
        
        
            <img class="header-picture" src="https://www.gravatar.com/avatar/0f50eb4dae65a5398f5884cbbc063ace?s=90" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="../#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/0f50eb4dae65a5398f5884cbbc063ace?s=110" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Koorosh</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Developer / Security Researcher</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../index.html"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../https:/github.com/kooroshh"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../https:/twitter.com/MrOplus"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Twitter"
                        >
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="../mailto:koorosh@programmer.net"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2021/08/23/GenericMalwareAnalysis-1/"
                            aria-label=": Android Malware Analysis"
                        >
                            Android Malware Analysis
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-08-23T23:57:43+04:30">
	
		    Aug 23, 2021
    	
    </time>
    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>today I’ve found a malware that sends its infected link via the victim’s phone using SMS. </p>
<p>When I’ve decompiled the infected apk file I’ve found that the malware has made using b4a [meh] but there were some little exciting parts in this malware.</p>
<h2 id="Firebase-as-C-amp-C-Server"><a href="#Firebase-as-C-amp-C-Server" class="headerlink" title="Firebase as C&amp;C Server"></a>Firebase as C&amp;C Server</h2><p>malware can receive commands using Firebase Cloud Messaging [and shame on firebase that does not have a section to report malware abuse] for example it can read device details and send them to a URL, change phone ring volume (to hijack SMS silently), hide the launcher, send SMS and send clipboard’s content to a URL</p>
<h2 id="Telegram-Bot-as-receiver"><a href="#Telegram-Bot-as-receiver" class="headerlink" title="Telegram Bot as receiver"></a>Telegram Bot as receiver</h2><p>the fun part and most stupid part of malware was embedding the telegram bot token in apk file =) </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1909576027:AAHjq2_0Z8f8zs0fiMPtyOL31Upc38b0mAg</span><br></pre></td></tr></table></figure>
<p>the service sends the data to a PHP file and that PHP file sends the data to telegram with specified chat id <code>-1001550879379</code></p>
<script src="//gist.github.com/c57ff08e5c66b7fd8928184798c22b79.js"></script>

<p>you can find the virus total report via <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/9c3e564dd99a0548cd7a42018f01cdb091b00528bef7b3603aea24ddf99b7e51/detection">VirusTotal</a></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2021/08/23/GenericMalwareAnalysis-1/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2021/02/14/Defence-Against-The-Dark-Arts/"
                            aria-label=": Defence Against The Dark Arts"
                        >
                            Defence Against The Dark Arts
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-02-14T17:01:38+03:30">
	
		    Feb 14, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="../categories/Web/">Web</a>, <a class="category-link" href="../categories/Web/Security/">Security</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h3 id="Defence-Against-The-Dark-Arts-Finding-User’s-Real-IP-Address"><a href="#Defence-Against-The-Dark-Arts-Finding-User’s-Real-IP-Address" class="headerlink" title="Defence Against The Dark Arts - Finding User’s Real IP Address"></a>Defence Against The Dark Arts - Finding User’s Real IP Address</h3><p>one of the biggest challenges in web security and web development is finding the user’s real IP address (and identify the GEO Location in some cases) when the user is behind a Proxy Server or VPN.</p>
<p>now if we utilize the user’s browser and force the browser to send the user’s real IP address from the user side, the problem can be solved.</p>
<p>there are lots of ways to enumerate the user’s NICs but in most situations, users are behind a NAT, which means their NICs IP Addresses are not useful! that’s where we need WebRTC API.</p>
<h3 id="What-is-WebRTC"><a href="#What-is-WebRTC" class="headerlink" title="What is WebRTC?"></a>What is WebRTC?</h3><p>WebRTC is a P2P communication API that supports NAT Traversal and works in almost <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/WebRTC#Support">all browsers</a> without the need to install any addons or plugins.</p>
<h3 id="ICE-Candidates"><a href="#ICE-Candidates" class="headerlink" title="ICE Candidates"></a>ICE Candidates</h3><p>to establish a connection between two peers, each peer should send its network information to the other one, including IP addresses.</p>
<h3 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h3><p>the following javascript code logs the user’s available IP addresses to the console.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">window.RTCPeerConnection &#x3D; window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;</span><br><span class="line">var connection &#x3D; new RTCPeerConnection(&#123;</span><br><span class="line">        &quot;iceServers&quot;: [&#123;</span><br><span class="line">            url: &quot;stun:stun.l.google.com:19302&quot;</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;);</span><br><span class="line">connection.createDataChannel(&quot;&quot;);</span><br><span class="line">connection.createOffer(connection.setLocalDescription.bind(connection), ()&#x3D;&gt;&#123;&#125;);</span><br><span class="line">connection.onicecandidate &#x3D; function(ice) &#123;</span><br><span class="line">    if (ice.candidate !&#x3D; null)</span><br><span class="line">        console.log(ice.candidate.address);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>now if we create a UUID for each session and send the candidate(s) with that session to the server, we can identify the user’s the real IP address</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2021/02/14/Defence-Against-The-Dark-Arts/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2021/01/31/TSCOBox-Security-Analysis/"
                            aria-label=": TSCOBox Security Analysis"
                        >
                            TSCOBox Security Analysis
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-01-31T11:05:40+03:30">
	
		    Jan 31, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="../categories/Application-Security-Analysis/">Application Security Analysis</a>, <a class="category-link" href="../categories/Application-Security-Analysis/Security/">Security</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h3 id="What-is-TSCO-Box"><a href="#What-is-TSCO-Box" class="headerlink" title="What is TSCO Box?"></a>What is TSCO Box?</h3><p>TSCO Box is an android tv box based on AllWinner H3 SoC, originally made by “WeChip” which re-branded as “TSCO” with some software modifications.<br><img src="/2021/01/31/TSCOBox-Security-Analysis/15657561632.jpg" alt="WeChip R69"></p>
<h3 id="Journey"><a href="#Journey" class="headerlink" title="Journey"></a>Journey</h3><p>I don’t own this box personally but I’ve found the software upgrade file from the Internet.<br>there are so many modified versions available on the Internet but fortunately, I’ve found the exact software upgrade file from their website.</p>
<p>the software upgrade file was actually an apk file, which upgrades the main launcher of the box.<br>That’s all! the whole software modifications were just an android launcher on top of the Chinese firmware.</p>
<h3 id="Insecure-API-Implementation"><a href="#Insecure-API-Implementation" class="headerlink" title="Insecure API Implementation"></a>Insecure API Implementation</h3><p>This launcher is too funny, for example, the launcher process the user registration at the same time, it sends the token key to the user exactly from itself! let’s see the code :<br><img src="/2021/01/31/TSCOBox-Security-Analysis/sms.png" alt="SMS"></p>
<p>now as you can see in the above image, the SMS Gateway API is hardcoded exactly in the application with the credentials!!!</p>
<p>but let’s dig in deeper</p>
<h3 id="Remote-Command-Execution"><a href="#Remote-Command-Execution" class="headerlink" title="Remote Command Execution"></a>Remote Command Execution</h3><p>There is a service that checks the remote APIs availabilities using the PING command<br>in the LB Finder Service, there is a method named isOnline that accepts a string and pass it to the PING command</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public boolean isOnline(String str) &#123;</span><br><span class="line">       Runtime runtime &#x3D; Runtime.getRuntime();</span><br><span class="line">       try &#123;</span><br><span class="line">           if (runtime.exec(&quot;&#x2F;system&#x2F;bin&#x2F;ping -c 1 &quot; + str).waitFor() &#x3D;&#x3D; 0) &#123;</span><br><span class="line">               return true;</span><br><span class="line">           &#125;</span><br><span class="line">           return false;</span><br><span class="line">       &#125; catch (IOException | InterruptedException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">           return false;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>the usage flow is like the below image :<br><img src="/2021/01/31/TSCOBox-Security-Analysis/rce-flow.png" alt="flow"></p>
<p>now what if we intercept the JsonNodeRequest and modify the IP to the <code>127.0.0.1 | rm -rf /sdcard</code>? yes! that’s possible because there is no IP validation in the code.<br>as far as the launcher is a kind of system app and the application manifest contains the following permissions it’s quite dangerous</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.ACCESS_NETWORK_STATE&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.SET_WALLPAPER&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.CHANGE_WIFI_STATE&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.ACCESS_WIFI_STATE&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.INTERNET&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.READ_EXTERNAL_STORAGE&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.ACCESS_FINE_LOCATION&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.ACCESS_COARSE_LOCATION&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.REQUEST_INSTALL_PACKAGES&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.READ_PHONE_STATE&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.WRITE_SETTINGS&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.WRITE_SECURE_SETTINGS&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;com.android.providers.tv.permission.WRITE_EPG_DATA&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;com.android.providers.tv.permission.READ_EPG_DATA&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;android.permission.WAKE_LOCK&quot;&#x2F;&gt;</span><br><span class="line">&lt;uses-permission android:name&#x3D;&quot;com.google.android.finsky.permission.BIND_GET_INSTALL_REFERRER_SERVICE&quot;&#x2F;&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Remote-API-Insecurity"><a href="#Remote-API-Insecurity" class="headerlink" title="Remote API Insecurity"></a>Remote API Insecurity</h3><p>The remote API was not secure at all, that was the most insecure web application I’ve ever seen.<br>it was written in Python using Django Framework with Debug Mode enabled which routed me to dump the whole user data, device locations, and details of every single piece of hardware they ever sold! </p>
<p>whole communications are based on HTTP and IP address which means almost everyone can intercept and modify the requests and responses</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2021/01/31/TSCOBox-Security-Analysis/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2021/01/21/AirMaster-Security-Analysis/"
                            aria-label=": AirMaster TD-LTE CPE Security Analysis"
                        >
                            AirMaster TD-LTE CPE Security Analysis
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-01-21T01:29:02+03:30">
	
		    Jan 21, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="../categories/Hardware-Hacking/">Hardware Hacking</a>, <a class="category-link" href="../categories/Hardware-Hacking/Security/">Security</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>AirMaster is a product family of KZ Broadband Technology “KZTech”.<br>There are numerous models such as 3000,3100,3100e,3100v that use the same firmware base. </p>
<p>in this post, I will discuss the 3000 model with firmware version 2.0.1B1047.</p>
<p>There are tons of backdoor included in the firmware with different methods.<br>however, I think some of them are logical bugs.</p>
<h3 id="How-did-I-get-root-access"><a href="#How-did-I-get-root-access" class="headerlink" title="How did I get root access!"></a>How did I get root access!</h3><p>I didn’t open this box physically to find UART / JTAG ports because I’ve found shell injection vulnerability on the Diagnostic page again! </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 | cat &#x2F;tmp&#x2F;nvramconfig&#x2F;RT2860_CONFIG_VLAN</span><br></pre></td></tr></table></figure>
<p>this simple command shows the nvram configuration file in the Ping result box.<br>there are many fun parts in this configuration file, like different access levels, SimLock status.</p>
<h3 id="Different-Access-Levels"><a href="#Different-Access-Levels" class="headerlink" title="Different Access Levels"></a>Different Access Levels</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Login&#x3D;Administrator</span><br><span class="line">Password&#x3D;M0LT3@4GN3T</span><br><span class="line">TelnetPwd&#x3D;root123</span><br><span class="line">GuestId&#x3D;admin</span><br><span class="line">GuestPassword&#x3D;admin</span><br><span class="line">Language&#x3D;en</span><br><span class="line">VipLogin&#x3D;VIP</span><br><span class="line">VipPassword&#x3D;V!P83869000</span><br></pre></td></tr></table></figure>
<p>as you can see, the admin is actually the guest and the Administrator user is the real admin, I don’t know much about the VIP user.<br>and the Telnet Password is root123 which is so weak! but the good point is telnet is disabled by default. </p>
<p>so how can we enable Telnet !? it’s simple, we should change the CSS =)<br>if we execute the following js command in the <code>System Maintenance</code> page we can enable the Debug Mode and Telnet.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;:hidden&quot;).show() ;</span><br></pre></td></tr></table></figure>
<h4 id="before-executing"><a href="#before-executing" class="headerlink" title="before executing :"></a>before executing :</h4><p><img src="/2021/01/21/AirMaster-Security-Analysis/before-js.png" alt="Before Executing"></p>
<h4 id="after-executing"><a href="#after-executing" class="headerlink" title="after executing :"></a>after executing :</h4><p><img src="/2021/01/21/AirMaster-Security-Analysis/after-js.png" alt="After Executing"></p>
<h3 id="Super-Cookie"><a href="#Super-Cookie" class="headerlink" title="Super Cookie"></a>Super Cookie</h3><p>if we put the following cookie <code>Cookie: kz_userid=Administrator:1 </code> in the cookie jar, we can get access to the CPE without any password! it’s fun and scary at the same time but this device is a Chinese one so it’s normal :)</p>
<h3 id="Deep-Inspection-of-GoAhead"><a href="#Deep-Inspection-of-GoAhead" class="headerlink" title="Deep Inspection of GoAhead"></a>Deep Inspection of GoAhead</h3><p><img src="/2021/01/21/AirMaster-Security-Analysis/syscmd.png" alt="System Command"><br>what is syscmd?<br>“syscmd.asp” is a page that you can execute shell commands! but it’s password protected and cookie protected (requires authentication)<br>as far as we had the Super Cookie we can bypass the authentication but what about the password ?! it’s quite simple, in this version the password is <code>super1234</code>, and boom! we can execute all commands exactly inside the web page!<br><img src="/2021/01/21/AirMaster-Security-Analysis/airmaster-syscmd.png" alt="System Command"></p>
<p>what if the device was sim locked?<br>let’s dig into the binary!<br><img src="/2021/01/21/AirMaster-Security-Analysis/lte.png" alt="LTE"><br>2 lines refer to the SimCard Restrictions, an asp page, and a form handler that handles the content of that asp page.<br>if we open <code>192.168.1.1/lte/simcardinfo.asp</code> using administrator credentials or the supercookie we can simply disable the restrictions!<br>if we open the page with admin (guest) credentials we should use the js command to show the hidden parts.<br><img src="/2021/01/21/AirMaster-Security-Analysis/restrict.png" alt="LTE Restriction"></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2021/01/21/AirMaster-Security-Analysis/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2021/01/20/ZLT-Security-Analysis/"
                            aria-label=": ZLT S12 Security Analysis"
                        >
                            ZLT S12 Security Analysis
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-01-20T00:48:59+03:30">
	
		    Jan 20, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="../categories/Security/">Security</a>, <a class="category-link" href="../categories/Security/Hardware-Hacking/">Hardware Hacking</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>ZLT S12  CPE is a cheap Chinese 4G CPE made by Shenzhen TOZED Technologies Co., LTD. also known as U.Tel in Iran or other names in some other countries.  </p>
<p><img src="/assets/images/zlt-s12.jpeg" alt="ZLT-S12"></p>
<p>as you can see from the board in the above picture the UART pins are located on the left of the board, the shell is completely unprotected  </p>
<p>the nvram configuration file is located under <code>/etc_rw/nv/main/cfg</code> which contains all users of the device  </p>
<p>the following dump contains the credentials of the device : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">user_Password&#x3D;admin</span><br><span class="line">user_user&#x3D;admin</span><br><span class="line">admin_Password&#x3D;9x07bm8mbN17c</span><br><span class="line">admin_user&#x3D;Root</span><br></pre></td></tr></table></figure>
<p>the <code>admin</code> user is the <code>user</code> with the lowest access level</p>
<p>there are tons of pages that are not visible to the user level such as Firmware Upgrade, PLMN Configurations, and…  </p>
<p><img src="/assets/images/utel-goahead-disassemble.png" alt="Disassembled Binary"><br>but after I’ve disassembled the <code>/bin/goahead</code> binary of the CPE I’ve found that the ping section under the Diagnostic page of the CPE contains the Shell Injection vulnerability so if I execute the <code>127.0.0.1 | cat /etc_rw/nv/main/cfg</code> the content of the cfg file returns instead of the ping command  </p>
<p><img src="/assets/images/utel-goahead-disassemble2.png" alt="Disassembled Binary"><br>not only the ping section even the traceroute section contains the shell injection!! </p>
<p>I’ve tried to dump the firmware but I’ve found that the firmware upgrade file already exists on the internet ONLY for resellers of the CPE, so when I’ve downloaded the firmware the file was a password-protected zip, after looking at the <code>/bin/goahead</code> binary and the upgrade process I’ve found that the uploaded file will be pass to the <code>/bin/tzextract</code>  </p>
<p>the <code>/bin/tzextract</code> is a bash script that unzips the uploaded file using the <code>tzp258keeper</code> password  </p>
<p>the extracted zip file exists on my <a target="_blank" rel="noopener" href="https://github.com/kooroshh/UtelRootfs">Github repository</a></p>
<p>if the device is SimLocked you can remove the imsi_prefix using <code>nv</code> command</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2021/01/20/ZLT-Security-Analysis/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="../2021/01/19/who-am-i/"
                            aria-label=": :$ whoami"
                        >
                            :$ whoami
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-01-19T03:59:03+03:30">
	
		    Jan 19, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="../categories/Drafts/">Drafts</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h3 id="whoami"><a href="#whoami" class="headerlink" title=":$ whoami"></a><code>:$ whoami</code></h3><p>in this blog, I will talk about security concerns and security problems of existing software/hardware and maybe make some tutorials </p>
<p>You may know me as “MrOplus” or “/dev/nvram” if you already know me, then ignore this post and keep move on</p>
<p>for those readers that don’t know me my name is Koorosh, some of my friends call me “K” I’m a college drop out (yes I am) and for now, I work as a full-stack engineer at <a target="_blank" rel="noopener" href="https://oorbit.tv/">Oorbit</a>  </p>
<p>for the past few years, I’ve worked as a Security Engineer, Embedded Developer, Full-Stack Developer, and mostly as a Mobile Developer</p>
<p>I can make cool things with some programming languages like Java, PHP, Python, Javascript, GoLang, C++(QT) on platforms like Android, Windows, Linux, macOS  </p>
<p>you can always contact me via <a href="mailto:koorosh@programmer.net">Koorosh@Programmer.net</a><br>this blog is based on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo">Hexo.js</a> and <a target="_blank" rel="noopener" href="https://github.com/LouisBarranqueiro/hexo-theme-tranquilpeak">TranquilPeak Theme</a>  </p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="../2021/01/19/who-am-i/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 Koorosh. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="https://www.gravatar.com/avatar/0f50eb4dae65a5398f5884cbbc063ace?s=110" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Koorosh</h4>
        
            <div id="about-card-bio"><p>Developer / Security Researcher</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Full-Stack Engineer</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('../assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="../assets/js/script-geudzlmpj1goapgmb72rzubebc2mv8uts5kivsyfzo3tkm10cgpfkdcwh6yn.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
